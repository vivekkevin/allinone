<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .chat-section { margin-bottom: 40px; border: 1px solid #ccc; padding: 20px; }
    .message-list { list-style-type: none; padding: 0; }
    .message-list li { margin: 5px 0; }
    .reply-form textarea { width: 100%; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Chat Dashboard</h1>

  <% chats.forEach((chat) => { %>
    <div class="chat-section">
      <h2>Chat with <%= chat.name %></h2>
      <p><strong>Email:</strong> <%= chat.email %></p>
      <p><strong>Platform:</strong> <%= chat.platform %></p>

      <h3>Messages</h3>
      <ul class="message-list">
        <% chat.messages.forEach((message) => { %>
          <li>
            <strong><%= message.sender %>:</strong>
            <%= message.message %>
            <em>(<%= new Date(message.timestamp).toLocaleString() %>)</em>
          </li>
        <% }); %>
      </ul>

      <h3>Send Reply</h3>
      <form class="reply-form" action="/chat/reply" method="POST">
        <input type="hidden" name="email" value="<%= chat.email %>">
        <textarea name="replyMessage" rows="4" placeholder="Type your reply here..." required></textarea>
        <button type="submit">Send</button>
      </form>
    </div>
  <% }); %>

</body>
</html>
